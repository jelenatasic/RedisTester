################################ NETWORK CONFIGURATION ########################

# port used by this redis node

port 7002

# closes connection after N seconds
# set zero to disable

timeout 0

################################# REPLICATION #################################

# node is slave node for node running on localhost
# using the port 7000

slaveof 127.0.0.1 7000

# when replication slave node will return stale data
# if request is made by client

slave-serve-stale-data yes

# slave priority config property is used by Sentinel
# to chose slave node to be promoted to master
# in case failover procedure is initiated
# slave with priority 0 is never selected as master

slave-priority 3

# setting the minimal number of slaves that need to be responsive
# in time span set by min-slaves-max-lag (value in seconds)
# in order for master to continue accepting writes
# otherwise it stops and will continue when reponsice replica number 
# increases to the minimum

min-slaves-to-write 1
min-slaves-max-lag 10

################################ SECURITY #####################################

# forces us to use authentification when bind is not specified
# redis node can be accessed from anywhere if bind is missing
# so this is the way to force protection
# default value

protected-mode yes

# since node is configured as slave and password is used for authentification
# replication is possible only if slave node authenticate using password

masterauth password321

# if events lead to slave promotion to master
# it will request password for authenication
# when requests are made from client or other slave node

requirepass password321

################################ REDIS LOG ####################################

# specifies the level of information logged
# debug level is used for debugging and testing
# it logs everything

loglevel debug
logfile "/home/redis/sentinel/log/7002.log"

################################ SNAPSHOTTING  ################################

# database snapshotting rules:
# save <seconds> <changes>
# after 900 sec if at least 1 key changed
# after 180 sec if at least 10 keys changed
# after 60 sec if at least 5000 keys changed

save 900 1
save 180 10
save 60 5000

# stop accepting writes is snapshot fails

stop-writes-on-bgsave-error yes

# uses LZF compression for strings before DB dump

rdbcompression yes

# when set to yes rdbchecksum forces checksum calculation
# for RDB dump
# has performance toll about 10% so it is disabled

rdbchecksum no

# dbfilename - the filename of the dump for DB
# dbfilename - the directory where to dump will be placed

dbfilename redis7002.rdb
dir /home/redis/sentinel/RDB
